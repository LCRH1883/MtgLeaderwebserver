{{define "content"}}
<h1>Users</h1>
<form method="get" action="/admin/users" class="search-row">
  <input type="search" name="q" placeholder="Search by email, username, or ID" value="{{.Query}}" />
  <button type="submit">Search</button>
  {{if .Query}}<a class="inline-link" href="/admin/users">Clear</a>{{end}}
</form>
{{if .Error}}<div class="alert">{{.Error}}</div>{{end}}
{{if .Notice}}<div class="notice">{{.Notice}}</div>{{end}}
<div class="card">
  <table class="table">
    <thead>
      <tr>
        <th>ID</th>
        <th>Email</th>
        <th>Username</th>
        <th>Status</th>
        <th>Joined</th>
        <th>Last Login</th>
        <th>Reset Password</th>
      </tr>
    </thead>
    <tbody>
      {{range .Users}}
      <tr>
        <td class="mono">{{.ID}}</td>
        <td>{{if .Email}}{{.Email}}{{else}}<span class="muted">â€”</span>{{end}}</td>
        <td>{{.Username}}</td>
        <td>{{.Status}}</td>
        <td>{{.JoinedAt}}</td>
        <td>{{.LastLogin}}</td>
        <td>
          <form method="post" action="/admin/users/reset" class="table-form">
            <input type="hidden" name="user_id" value="{{.ID}}" />
            <input type="hidden" name="q" value="{{$.Query}}" />
            <input name="new_password" type="password" autocomplete="new-password" placeholder="New password" required />
            <input name="confirm_password" type="password" autocomplete="new-password" placeholder="Confirm" required />
            <button type="submit">Reset</button>
          </form>
        </td>
      </tr>
      {{end}}
    </tbody>
  </table>
  {{if and (not .Users) .Query}}
    <p class="muted">No users match "{{.Query}}".</p>
  {{end}}
</div>
{{end}}
{{define "users.html"}}{{template "layout" .}}{{end}}
